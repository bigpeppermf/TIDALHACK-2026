\documentclass[12pt]{article}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage{cancel}
\geometry{a4paper, margin=1in}

\begin{document}

\section*{MATH 151 Section 3.4 The Chain Rule}

Find derivatives of the following compositions of functions

\begin{align*}
(1) \quad h(x) &= (2x - 1)^2 = (2x - 1)(2x - 1) = 4x^2 - 4x + 1 \\
&\quad \text{So } h'(x) = 8x - 4 = 2(4x-2) = 2(2x-1) \cdot 2 \quad \text{(Power Rule: } ((2x-1)^2)' = 2(2x-1)) \\
(2) \quad h(x) &= (3x + 1)^2 = (3x + 1)(3x + 1) = 9x^2 + 6x + 1 \\
&\quad \text{So } h'(x) = 18x + 6 = 2(9x+3) = 2(3x+1) \cdot 3 \quad \text{(Power Rule: } ((3x+1)^2)' = 2(3x+1)) \\
(3) \quad h(x) &= (x^2 + 1)^2 = (x^2 + 1)(x^2 + 1) = x^4 + 2x^2 + 1 \\
&\quad \text{So } h'(x) = 4x^3 + 4x = 2(2x^3+2x) = 2(x^2+1) \cdot 2x \quad \text{(Power Rule: } ((x^2+1)^2)' = 2(x^2+1)) \\
(4) \quad h(x) &= \sqrt{5x+1} = (5x+1)^{\frac{1}{2}} \\
&\quad h'(x) = \frac{1}{2}(5x+1)^{-\frac{1}{2}} \cdot 5 \\
&\quad h(x) = \frac{3}{4x-1} = 3(4x-1)^{-1} \\
&\quad h'(x) = -3(4x-1)^{-2} \cdot 4
\end{align*}

Note that each function $h$ is indeed compositions of functions, $h = f \circ g = f(g(x))$.
For the derivative of $f(g(x))$, you need $f'(g(x))$ as well as an extra term, namely $g'(x)$.

\section*{The Chain Rule}
Suppose the derivatives $g'(x)$ and $f'(g(x))$ both exist. Then the composition $F = f \circ g = f(g(x))$ has the derivative
\begin{align*}
F'(x) = f'(g(x)) g'(x)
\end{align*}
% [Diagram: Flowchart showing x maps to g(x) via g, and g(x) maps to f(g(x)) via f. The direct map from x to f(g(x)) is f o g.]

In Leibniz notation, if $y = f(u)$ and $u = u(x)$ are both differentiable functions, then
\begin{align*}
\frac{dy}{dx} = \frac{df}{du} \frac{du}{dx}
\end{align*}
% [Diagram: Flowchart showing x maps to u=u(x) via u, and u=u(x) maps to f(u)=y via f. The direct map from x to f(u)=y is f o u.]

Is it really canceling?
\begin{align*}
\frac{df}{\cancel{du}} \frac{\cancel{du}}{dx} = \frac{df}{dx} = \frac{dy}{dx}
\end{align*}
NO and YES in sect 3.10 for now

\end{document}